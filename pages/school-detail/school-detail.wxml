<view class="container">
  <view wx:if="{{loading}}" class="loading">
    <loading>åŠ è½½ä¸­...</loading>
  </view>
  
  <view wx:else class="school-detail">
    <!-- é¡¶éƒ¨åˆ‡æ¢æ  -->
    <view class="tab-bar">
      <view class="tab-item {{activeTab === 'school' ? 'active' : ''}}" 
            bindtap="switchTab" 
            data-tab="school">
        å­¦æ ¡è¯¦æƒ…
      </view>
      <view class="tab-item {{activeTab === 'major' ? 'active' : ''}}" 
            bindtap="switchTab" 
            data-tab="major">
        ä¸“ä¸šè¯¦æƒ…
      </view>
    </view>

    <!-- å­¦æ ¡è¯¦æƒ…å†…å®¹ -->
    <view class="content-area" hidden="{{activeTab !== 'school'}}">
      <!-- å­¦æ ¡åŸºæœ¬ä¿¡æ¯ -->
      <view class="header">
        <image class="school-logo" 
               src="{{school.logo || '/images/default-university-logo.png'}}" 
               mode="aspectFit"/>
        <view class="school-title">
          <text class="school-name">{{school.name}}</text>
          <view class="school-tags">
            <text class="tag">{{school.type}}</text>
            <text class="tag">{{school.location}}</text>
          </view>
        </view>
      </view>

      <!-- å­¦æ ¡ç­‰çº§ -->
      <view class="section" wx:if="{{school.level}}">
        <view class="section-title">å­¦æ ¡ç­‰çº§</view>
        <view class="level-info">{{school.level}}</view>
      </view>

      <!-- å­¦æ ¡ç®€ä»‹ -->
      <view class="section" wx:if="{{school.description}}">
        <view class="section-title">å­¦æ ¡ç®€ä»‹</view>
        <view class="description">{{school.description}}</view>
      </view>

      <!-- åŸºæœ¬ä¿¡æ¯ -->
      <view class="section">
        <view class="section-title">åŸºæœ¬ä¿¡æ¯</view>
        <view class="info-list">
          <view class="info-item" wx:if="{{school.established}}">
            <text class="label">åˆ›åŠæ—¶é—´ï¼š</text>
            <text class="value">{{school.established}}</text>
          </view>
          <view class="info-item" wx:if="{{school.students}}">
            <text class="label">åœ¨æ ¡ç”Ÿè§„æ¨¡ï¼š</text>
            <text class="value">{{school.students}}</text>
          </view>
          <view class="info-item" wx:if="{{school.academicians}}">
            <text class="label">é™¢å£«äººæ•°ï¼š</text>
            <text class="value">{{school.academicians}}</text>
          </view>
          <view class="info-item" wx:if="{{school.keyLabs}}">
            <text class="label">é‡ç‚¹å®éªŒå®¤ï¼š</text>
            <text class="value">{{school.keyLabs}}</text>
          </view>
          <view class="info-item" wx:if="{{school.website}}">
            <text class="label">å®˜æ–¹ç½‘ç«™ï¼š</text>
            <text class="value link" bindtap="copyWebsite" data-url="{{school.website}}">{{school.website}}</text>
          </view>
        </view>
      </view>

      <!-- ç‰¹è‰²ä¼˜åŠ¿ -->
      <view class="section" wx:if="{{school.features.length > 0}}">
        <view class="section-title">ç‰¹è‰²ä¼˜åŠ¿</view>
        <view class="features-list">
          <view class="feature-item" wx:for="{{school.features}}" wx:key="*this">
            <text class="dot">â€¢</text>
            <text>{{item}}</text>
          </view>
        </view>
      </view>

      <!-- ä¼˜åŠ¿ä¸“ä¸š -->
      <view class="section" wx:if="{{school.majors.length > 0}}">
        <view class="section-title">ä¼˜åŠ¿ä¸“ä¸š</view>
        <view class="majors-list">
          <view class="major-item" 
                wx:for="{{school.majors}}" 
                wx:key="*this"
                bindtap="navigateToMajor"
                data-major="{{item}}">
            {{item}}
          </view>
        </view>
      </view>
    </view>

    <!-- ä¸“ä¸šè¯¦æƒ…å†…å®¹ -->
    <view class="content-area" hidden="{{activeTab !== 'major'}}">
      <view class="major-container">
        <!-- å·¦ä¾§ä¸“ä¸šå¤§ç±»åˆ—è¡¨ -->
        <view class="category-list">
          <view class="category-item {{item.isExpanded ? 'active' : ''}}"
                wx:for="{{majorCategories}}"
                wx:key="name"
                bindtap="onCategoryTap"
                data-index="{{index}}">
            {{item.name}}
          </view>
        </view>

        <!-- å³ä¾§å†…å®¹åŒºåŸŸ -->
        <view class="major-content">
          <block wx:if="{{!selectedMajor}}">
            <!-- æ˜¾ç¤ºäºŒçº§åˆ†ç±»åˆ—è¡¨åŠå…¶ä¸“ä¸š -->
            <view wx:for="{{majorCategories}}" 
                  wx:key="name"
                  wx:for-item="category"
                  wx:for-index="categoryIndex">
              
              <!-- åªæ˜¾ç¤ºå±•å¼€çš„å¤§ç±»çš„å†…å®¹ -->
              <block wx:if="{{category.isExpanded}}">
                <view wx:for="{{category.subcategories}}" 
                      wx:key="name"
                      wx:for-item="subcategory"
                      wx:for-index="subIndex"
                      class="subcategory-group">
                  <view class="subcategory-item {{subcategory.isExpanded ? 'active' : ''}}"
                        bindtap="onSubcategoryTap"
                        data-category-index="{{categoryIndex}}"
                        data-sub-index="{{subIndex}}">
                    {{subcategory.name}}
                  </view>
                  
                  <!-- æ˜¾ç¤ºå±•å¼€çš„äºŒçº§åˆ†ç±»çš„ä¸“ä¸šåˆ—è¡¨ -->
                  <view class="major-list" 
                        wx:if="{{subcategory.isExpanded}}">
                    <view class="major-item"
                          wx:for="{{subcategory.majors}}"
                          wx:for-item="major"
                          wx:key="name"
                          bindtap="onMajorTap"
                          data-major="{{major}}">
                      {{major.name}}
                    </view>
                  </view>
                </view>
              </block>
            </view>
          </block>

          <!-- ä¸“ä¸šè¯¦ç»†ä¿¡æ¯ -->
          <view class="major-detail" wx:else>
            <view class="major-header">
              <text class="back-button" bindtap="onBackToList">è¿”å›åˆ—è¡¨</text>
              <view class="major-title">
                <text class="major-name">{{selectedMajor.name}}</text>
                <text class="major-code">ä¸“ä¸šä»£ç ï¼š{{selectedMajor.code}}</text>
              </view>
            </view>
            
            <view class="major-content-detail">
              <!-- ä¸“ä¸šä»‹ç» -->
              <view class="major-section">
                <view class="section-title">
                  <text class="icon">ğŸ“š</text>
                  <text>ä¸“ä¸šä»‹ç»</text>
                </view>
                <text class="section-content">{{selectedMajor.introduction}}</text>
              </view>
              
              <!-- ä¸»è¦ç‰¹è‰² -->
              <view class="major-section">
                <view class="section-title">
                  <text class="icon">ğŸŒŸ</text>
                  <text>ä¸»è¦ç‰¹è‰²</text>
                </view>
                <view class="features-grid">
                  <view class="feature-tag" wx:for="{{selectedMajor.features}}" wx:key="*this">
                    {{item}}
                  </view>
                </view>
              </view>

              <!-- ä¸»è¦è¯¾ç¨‹ -->
              <view class="major-section">
                <view class="section-title">
                  <text class="icon">ğŸ“–</text>
                  <text>ä¸»è¦è¯¾ç¨‹</text>
                </view>
                <view class="course-grid">
                  <view class="course-item" wx:for="{{selectedMajor.courses}}" wx:key="*this">
                    {{item}}
                  </view>
                </view>
              </view>
              
              <!-- å°±ä¸šæ–¹å‘ -->
              <view class="major-section">
                <view class="section-title">
                  <text class="icon">ğŸ¯</text>
                  <text>å°±ä¸šæ–¹å‘</text>
                </view>
                <text class="section-content">{{selectedMajor.career}}</text>
              </view>
            </view>
          </view>
        </view>
      </view>
    </view>
  </view>
</view> 